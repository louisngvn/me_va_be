<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEBUG - N√£o b·ªô & Th·ªã l·ª±c</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #6366f1 0%, #3b82f6 25%, #1d4ed8 50%, #1e40af 75%, #3730a3 100%); min-height: 100vh; }
        .glass-effect { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        .flip-card { background-color: transparent; width: 100%; height: 520px; perspective: 1000px; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.7s; transform-style: preserve-3d; }
        .flip-card.is-flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; border-radius: 1.5rem; }
        .flip-card-back { transform: rotateY(180deg); padding: 1.5rem; display: flex; flex-direction: column; overflow-y: auto; }
    </style>
</head>
<body class="text-gray-800">

    <!-- Debug Panel -->
    <div id="debug-panel" class="fixed top-4 left-4 bg-black/80 text-white p-4 rounded-lg text-sm z-50 max-w-md">
        <h3 class="font-bold mb-2">üêõ DEBUG INFO</h3>
        <div id="debug-info"></div>
        <button onclick="document.getElementById('debug-panel').style.display='none'" class="mt-2 px-2 py-1 bg-red-600 rounded text-xs">·∫®n</button>
    </div>

    <!-- Header -->
    <header class="glass-effect sticky top-0 z-40 border-b border-white/20">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-center items-center">
                <h1 class="text-xl md:text-2xl font-bold text-white">
                    üß† DEBUG - S·∫£n ph·∫©m N√£o b·ªô & Th·ªã l·ª±c
                </h1>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container mx-auto p-4 md:p-8 mt-8">
        <div class="text-center mb-8">
            <h2 class="text-3xl font-bold text-white mb-4">Ki·ªÉm tra hi·ªÉn th·ªã s·∫£n ph·∫©m</h2>
            <div id="product-count" class="text-white/80 text-lg"></div>
        </div>

        <!-- Products Grid -->
        <div id="product-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
            <!-- Products s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
        </div>

        <!-- No Products Message -->
        <div id="no-products" class="hidden text-center py-16">
            <div class="glass-effect p-12 rounded-3xl">
                <h3 class="text-2xl font-bold text-white mb-4">‚ùå KH√îNG C√ì S·∫¢N PH·∫®M</h3>
                <p class="text-white/70">Ki·ªÉm tra Console ƒë·ªÉ xem l·ªói chi ti·∫øt</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // Debug function
            function debugLog(message) {
                console.log('üêõ DEBUG:', message);
                const debugInfo = document.getElementById('debug-info');
                if (debugInfo) {
                    debugInfo.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
                }
            }

            debugLog('Script b·∫Øt ƒë·∫ßu ch·∫°y');

            const app = {
                // Test products data
                products: [
                    {
                        id: 101,
                        category: 'nao_bo',
                        name: 'Nordic Naturals Baby\'s DHA',
                        brand: 'Nordic Naturals',
                        image: 'https://placehold.co/300x300/3b82f6/white?text=Nordic+Baby+DHA',
                        price: 520000,
                        volume_ml: 60,
                        total_doses_per_bottle: 120,
                        origin: {country: 'M·ªπ', continent: 'Ch√¢u M·ªπ'},
                        form: 'drops',
                        declared_dose: { unit_count: 1, unit_name: 'ml', dha_mg: 37, epa_mg: 60, omega3_total: 480 },
                        dosage_recommendation: { 'duoi_1_tuoi': { min: 0.5, max: 1, unit: 'ml' }, 'tu_1_den_3_tuoi': { min: 1, max: 1.5, unit: 'ml' }, 'tu_3_den_12_tuoi': { min: 1.5, max: 2, unit: 'ml' } },
                        ingredients_details: { omega3_source: 'C√° bi·ªÉn', purity: 'Molecular distillation', flavor: 'Strawberry' },
                        rating: 4.8,
                        reviews: 234,
                        product_url: 'https://nordicnaturals.vn/',
                        summary: {
                            benefits: [
                                'H·ªó tr·ª£ ph√°t tri·ªÉn n√£o b·ªô v√† th·ªã l·ª±c c·ªßa tr·∫ª s∆° sinh v√† tr·∫ª nh·ªè.',
                                'C·∫£i thi·ªán kh·∫£ nƒÉng h·ªçc t·∫≠p v√† ghi nh·ªõ.',
                                'TƒÉng c∆∞·ªùng h·ªá mi·ªÖn d·ªãch t·ª± nhi√™n.'
                            ],
                            ingredients: [
                                'DHA t·ª´ c√° bi·ªÉn 37mg/ml',
                                'EPA 60mg/ml',
                                'Omega-3 t·ªïng 480mg/ml',
                                'H∆∞∆°ng d√¢u t·ª± nhi√™n'
                            ],
                            users: 'Tr·∫ª s∆° sinh t·ª´ 6 th√°ng, tr·∫ª nh·ªè v√† ph·ª• n·ªØ mang thai.'
                        }
                    },
                    {
                        id: 108,
                        category: 'nao_bo', 
                        name: 'BioAmicus DHA', 
                        brand: 'BioAmicus', 
                        image: 'https://placehold.co/300x300/3b82f6/white?text=BioAmicus+DHA',
                        price: 385000,
                        volume_ml: 30,
                        total_doses_per_bottle: 60,
                        origin: {country: 'Canada', continent: 'Ch√¢u M·ªπ'}, 
                        form: 'drops',
                        declared_dose: {
                            unit_count: 1, 
                            unit_name: 'li·ªÅu (0.5ml)', 
                            dha_mg: 100,
                            epa_mg: 20,
                            omega3_total: 140
                        },
                        dosage_recommendation: {
                            'duoi_1_tuoi': { min: 1, max: 1, unit: 'li·ªÅu' },
                            'tu_1_den_3_tuoi': { min: 2, max: 2, unit: 'li·ªÅu' },
                            'tu_3_den_12_tuoi': { min: 3, max: 3, unit: 'li·ªÅu' }
                        },
                        ingredients_details: { 
                            omega3_source: 'D·∫ßu c√° tinh khi·∫øt', 
                            purity: 'Pharmaceutical grade',
                            flavor: 'T·ª± nhi√™n' 
                        },
                        rating: 4.7,
                        reviews: 156,
                        product_url: 'https://bioamicus.vn/bioamicus-dha',
                        summary: {
                            benefits: [
                                'B·ªï sung 100mg DHA v√† 20mg EPA m·ªói li·ªÅu 0.5ml',
                                'H·ªó tr·ª£ ph√°t tri·ªÉn n√£o b·ªô v√† th·ªã l·ª±c tr·∫ª em',
                                'T·ª´ d·∫ßu c√° tinh khi·∫øt, an to√†n cho tr·∫ª s∆° sinh',
                                'Li·ªÅu d√πng r√µ r√†ng theo t·ª´ng ƒë·ªô tu·ªïi'
                            ],
                            ingredients: [
                                'DHA (Docosahexaenoic Acid) 100mg/0.5ml',
                                'EPA (Eicosapentaenoic Acid) 20mg/0.5ml', 
                                'Omega-3 t·ªïng: 140mg/0.5ml',
                                'D·∫ßu c√° tinh khi·∫øt'
                            ],
                            users: 'Tr·∫ª s∆° sinh t·ª´ 0-12 th√°ng (1 li·ªÅu/ng√†y), tr·∫ª em 1-6 tu·ªïi (2 li·ªÅu/ng√†y), tr·∫ª 7-11 tu·ªïi (3 li·ªÅu/ng√†y)'
                        }
                    }
                ],

                init: function() {
                    debugLog('App init() ƒë∆∞·ª£c g·ªçi');
                    
                    try {
                        const naoBoproducts = this.products.filter(p => p.category === 'nao_bo');
                        debugLog('T√¨m th·∫•y ' + naoBoproducts.length + ' s·∫£n ph·∫©m nao_bo');
                        
                        this.renderProducts(naoBoproducts);
                        this.updateProductCount(naoBoproducts.length);
                        
                        debugLog('Render ho√†n th√†nh');
                        
                    } catch (error) {
                        debugLog('L·ªñI trong init(): ' + error.message);
                        console.error('Chi ti·∫øt l·ªói:', error);
                    }
                },

                renderProducts: function(productsToRender) {
                    debugLog('renderProducts() ƒë∆∞·ª£c g·ªçi v·ªõi ' + productsToRender.length + ' s·∫£n ph·∫©m');
                    
                    const grid = document.getElementById('product-grid');
                    const noProducts = document.getElementById('no-products');
                    
                    if (!grid) {
                        debugLog('L·ªñI: Kh√¥ng t√¨m th·∫•y element product-grid');
                        return;
                    }

                    if (productsToRender.length === 0) {
                        debugLog('Kh√¥ng c√≥ s·∫£n ph·∫©m ƒë·ªÉ hi·ªÉn th·ªã');
                        grid.innerHTML = '';
                        noProducts.classList.remove('hidden');
                        return;
                    }
                    
                    noProducts.classList.add('hidden');
                    
                    try {
                        grid.innerHTML = productsToRender.map(product => {
                            const doseInfo = product.dosage_recommendation.duoi_1_tuoi || product.dosage_recommendation.tu_1_den_3_tuoi;
                            const dailyDose = doseInfo ? doseInfo.min : 1;
                            const dailyCost = Math.round((product.price / product.total_doses_per_bottle) * dailyDose);

                            return `
                            <div class="product-card" data-product-id="${product.id}">
                                <div class="flip-card card-hover">
                                    <div class="flip-card-inner">
                                        <div class="flip-card-front glass-effect p-6 rounded-3xl flex flex-col">
                                            <div class="relative mb-4">
                                                <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover rounded-2xl">
                                                <div class="absolute top-3 right-3">
                                                    <span class="px-3 py-1 bg-gradient-to-r from-blue-500 to-indigo-600 text-white text-xs font-semibold rounded-full">
                                                        ${product.origin.country}
                                                    </span>
                                                </div>
                                            </div>
                                            
                                            <h3 class="font-bold text-lg text-white mb-2 line-clamp-2 h-14">${product.name}</h3>
                                            <p class="text-white/70 text-sm mb-3">${product.brand}</p>
                                            
                                            <div class="space-y-2 mb-4 border-t border-b border-white/10 py-3">
                                                <div class="flex justify-between text-sm">
                                                    <span class="text-white/70">DHA:</span>
                                                    <span class="text-white font-medium">${product.declared_dose.dha_mg} mg</span>
                                                </div>
                                                <div class="flex justify-between text-sm">
                                                    <span class="text-white/70">Omega-3:</span>
                                                    <span class="text-white font-medium">${product.declared_dose.omega3_total} mg</span>
                                                </div>
                                            </div>
                                            
                                            <div class="mt-auto">
                                                <div class="flex justify-between items-center">
                                                    <div>
                                                        <span class="text-2xl font-bold text-white">${product.price.toLocaleString('vi-VN')}</span>
                                                        <span class="text-white/70 text-sm">ƒë</span>
                                                    </div>
                                                    <div class="text-right">
                                                        <span class="font-bold text-blue-400">${dailyCost.toLocaleString('vi-VN')}ƒë</span>
                                                        <span class="text-xs text-white/70 block">/ ng√†y</span>
                                                    </div>
                                                </div>
                                                <div class="flex gap-2 mt-3">
                                                    <a href="${product.product_url}" target="_blank" class="flex-1 block text-center px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-xl hover:shadow-lg transform hover:scale-105 transition-all duration-300 text-sm">
                                                        üí∞ Mua ngay
                                                    </a>
                                                    <button class="flex-1 block text-center px-4 py-2 bg-white/10 text-white font-semibold rounded-xl hover:bg-white/20 transition-all duration-300 text-sm flip-trigger">
                                                        Chi ti·∫øt
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flip-card-back glass-effect">
                                            <div class="flex-grow overflow-y-auto pr-2">
                                                <h4 class="font-bold text-lg mb-2 text-blue-200">C√¥ng d·ª•ng ch√≠nh</h4>
                                                <ul class="mb-4">
                                                    ${product.summary.benefits.map(b => `<li class="mb-1 text-white/90 text-sm">‚úì ${b}</li>`).join('')}
                                                </ul>
                                                <h4 class="font-bold text-lg mb-2 text-blue-200">Th√†nh ph·∫ßn n·ªïi b·∫≠t</h4>
                                                <ul class="mb-4">
                                                    ${product.summary.ingredients.map(i => `<li class="mb-1 text-white/90 text-sm">‚Ä¢ ${i}</li>`).join('')}
                                                </ul>
                                                <h4 class="font-bold text-lg mb-2 text-blue-200">ƒê·ªëi t∆∞·ª£ng s·ª≠ d·ª•ng</h4>
                                                <p class="text-sm text-white/90">${product.summary.users}</p>
                                            </div>
                                            <div class="flex gap-2 mt-4 pt-2 border-t border-white/20">
                                                <a href="${product.product_url}" target="_blank" class="flex-1 block text-center px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 font-semibold rounded-xl hover:shadow-lg transition-all text-sm text-white">
                                                    T·ªõi trang SP
                                                </a>
                                                <button class="flex-1 text-white/80 hover:text-white transition-colors flip-trigger-back bg-white/10 rounded-xl py-2 text-sm font-semibold">
                                                    Quay l·∫°i
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `}).join('');
                        
                        debugLog('HTML ƒë∆∞·ª£c render th√†nh c√¥ng');
                        
                        // Setup flip card events
                        this.setupFlipEvents();
                        
                    } catch (error) {
                        debugLog('L·ªñI khi render HTML: ' + error.message);
                        console.error('Chi ti·∫øt l·ªói render:', error);
                    }
                },

                setupFlipEvents: function() {
                    debugLog('Setup flip card events');
                    
                    const grid = document.getElementById('product-grid');
                    if (grid) {
                        grid.addEventListener('click', (e) => {
                            const flipTrigger = e.target.closest('.flip-trigger');
                            const flipTriggerBack = e.target.closest('.flip-trigger-back');
                            
                            if (flipTrigger || flipTriggerBack) {
                                const card = (flipTrigger || flipTriggerBack).closest('.flip-card');
                                if (card) {
                                    card.classList.toggle('is-flipped');
                                    debugLog('Flip card toggled');
                                }
                            }
                        });
                    }
                },

                updateProductCount: function(count) {
                    debugLog('C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng s·∫£n ph·∫©m: ' + count);
                    const countEl = document.getElementById('product-count');
                    if (countEl) {
                        countEl.textContent = `T√¨m th·∫•y ${count} s·∫£n ph·∫©m`;
                    }
                }
            };

            // Kh·ªüi ch·∫°y app
            debugLog('B·∫Øt ƒë·∫ßu kh·ªüi ch·∫°y app...');
            app.init();
            debugLog('App ƒë√£ kh·ªüi ch·∫°y xong');
        });
    </script>
</body>
</html>