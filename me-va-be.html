<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vi Chất Cho Mẹ và Bé - Sức khỏe Phụ nữ & Thai kỳ</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="So sánh 15+ sản phẩm Sắt, Axit Folic, Vitamin cho phụ nữ mang thai và cho con bú tại Việt Nam. Tìm sản phẩm phù hợp với bộ lọc thông minh.">
    <meta name="keywords" content="sắt, axit folic, vitamin bầu, mẹ cho con bú, vitamin phụ nữ, sức khỏe thai kỳ">
    
    <!-- Import Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Import Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #a855f7 0%, #c084fc 25%, #e879f9 50%, #f472b6 75%, #fb7185 100%);
            min-height: 100vh;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .header-glass {
            background-color: rgba(168, 85, 247, 0.8);
            backdrop-filter: blur(10px);
        }

        .gradient-text {
            background: linear-gradient(135deg, #c084fc 0%, #e879f9 50%, #f472b6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .card-hover:hover .flip-card-front {
             box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        .floating-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.1); border-radius: 4px; }
        ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.3); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.5); }
        
        /* Product card selected state */
        .product-card.selected .flip-card-front {
            border: 2px solid #10b981;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
        }
        
        /* Notification styles */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        /* Line clamp utility */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Style cho accordion filter */
        details > summary {
            cursor: pointer;
            font-weight: 600;
            color: #f3f4f6; /* text-gray-100 */
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
        }
        details > summary::after {
            content: '›';
            transform: rotate(90deg);
            transition: transform 0.2s;
            font-size: 1.5em;
        }
        details[open] > summary::after {
            transform: rotate(-90deg);
        }
        .comparison-bar {
            transition: width 0.5s ease-in-out;
        }

        .underline-reveal {
            position: relative;
            display: inline-block;
            color: #FFF8E1;
            text-shadow: 0 0 5px rgba(0,0,0,0.3);
        }

        .underline-reveal::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 2px;
            bottom: -8px;
            left: 0;
            background-color: #FCE7F3;
            transform: scaleX(0);
            animation: sweep-underline 3s ease-in-out infinite;
            animation-delay: 1s;
        }

        @keyframes sweep-underline {
            0% { transform: scaleX(0); transform-origin: left; }
            45% { transform: scaleX(1); transform-origin: left; }
            55% { transform: scaleX(1); transform-origin: right; }
            100% { transform: scaleX(0); transform-origin: right; }
        }

        /* --- FLIP CARD STYLES --- */
        .flip-card {
            background-color: transparent;
            width: 100%;
            height: 520px; /* Fixed height for consistency */
            perspective: 1000px;
        }
        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.7s;
            transform-style: preserve-3d;
        }
        .flip-card.is-flipped .flip-card-inner {
            transform: rotateY(180deg);
        }
        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden; /* Safari */
            backface-visibility: hidden;
            border-radius: 1.5rem; /* rounded-3xl */
        }
        .flip-card-back {
            transform: rotateY(180deg);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        .flip-card-back h4 {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: #FCE7F3;
        }
        .flip-card-back ul {
            list-style-type: none;
            padding-left: 0;
            font-size: 0.9rem;
            color: white;
            opacity: 0.9;
            flex-grow: 1;
        }
        .flip-card-back ul li {
            padding-left: 1.25rem;
            position: relative;
            margin-bottom: 0.5rem;
        }
        .flip-card-back ul li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #34D399; /* emerald-400 */
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header with Glass Effect -->
    <header class="header-glass sticky top-0 z-40 border-b border-white/20">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-r from-purple-600 to-pink-700 rounded-xl flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.321h5.365c.414 0 .584.536.283.766l-4.34 3.16a.563.563 0 0 0-.182.635l1.63 5.85c.128.463-.386.848-.794.536l-4.82-3.522a.563.563 0 0 0-.666 0l-4.82 3.522c-.408.312-.922-.073-.794-.536l1.63-5.85a.563.563 0 0 0-.182-.635l-4.34-3.16c-.301-.23-.131-.766.283-.766h5.365a.563.563 0 0 0 .475-.321L11.48 3.5Z"></path>
                        </svg>
                    </div>
                    <h1 class="text-xl md:text-2xl font-bold text-white">
                        Vi Chất Cho Mẹ và Bé
                    </h1>
                </div>
                <nav class="hidden md:flex space-x-6 text-white/80 font-medium items-center">
                    <a href="index.html" class="hover:text-white transition-colors">Xương & Răng</a>
                    <a href="nao-bo.html" class="hover:text-white transition-colors">Não bộ & Thị lực</a>
                    <a href="de-khang.html" class="hover:text-white transition-colors">Đề kháng & Tiêu hóa</a>
                    <a href="me-va-be.html" class="hover:text-white transition-colors text-purple-200">Mẹ & Bé</a>
                    <div class="relative" id="compare-menu-container">
                        <button id="compare-btn" class="px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-700 rounded-xl hover:shadow-lg transition-all duration-300 flex items-center space-x-2 opacity-50" disabled>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                            <span>So sánh (<span id="compare-count">0</span>)</span>
                        </button>
                        <div id="compare-dropdown" class="hidden absolute top-full mt-2 w-56 rounded-xl glass-effect text-white p-2 z-50">
                            <a href="#" data-compare-type="dosage" class="block px-4 py-2 text-sm hover:bg-white/10 rounded-lg">So sánh liều dùng</a>
                            <a href="#" data-compare-type="cost" class="block px-4 py-2 text-sm hover:bg-white/10 rounded-lg">So sánh chi phí/ngày</a>
                            <a href="#" data-compare-type="iron" class="block px-4 py-2 text-sm hover:bg-white/10 rounded-lg">So sánh hàm lượng Sắt</a>
                            <a href="#" data-compare-type="folic_acid" class="block px-4 py-2 text-sm hover:bg-white/10 rounded-lg">So sánh hàm lượng Axit Folic</a>
                        </div>
                    </div>
                    <a href="expert.html" class="hover:text-white transition-colors">Chuyên gia</a>
                </nav>
                <button class="md:hidden text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="relative py-20 overflow-hidden">
        <div class="container mx-auto px-4 text-center">
            <div class="floating-animation">
                <h2 class="text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight">
                    <span class="text-white/90">Sức khỏe mẹ vàng,</span><br>
                    <span class="underline-reveal">con khỏe mạnh</span>
                </h2>
                <p class="text-lg md:text-xl text-white/80 max-w-3xl mx-auto mb-8 leading-relaxed">
                    Tìm sản phẩm Sắt, Axit Folic và vitamin tốt nhất để hỗ trợ sức khỏe phụ nữ trong thai kỳ và thời kỳ cho con bú.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                    <button onclick="document.getElementById('products').scrollIntoView({behavior: 'smooth'})" class="px-8 py-4 bg-gradient-to-r from-purple-600 to-pink-700 text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300">
                        Xem Sản Phẩm
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Product Categories Section -->
    <section id="product-categories" class="container mx-auto px-4 md:px-8 -mt-16 relative z-10">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- Card 1: Xương, Răng -->
            <div class="glass-effect p-6 rounded-3xl text-white card-hover opacity-70 flex flex-col justify-between">
                <div class="text-center">
                    <div class="mx-auto w-16 h-16 mb-4 bg-white/20 rounded-full flex items-center justify-center">
                        <svg class="w-8 h-8 text-amber-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18" />
                        </svg>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Hỗ trợ Xương, Răng & Chiều cao</h3>
                    <p class="text-sm text-white/70 mb-4">Vitamin D3, K2, Canxi và các khoáng chất thiết yếu.</p>
                </div>
                <a href="index.html" class="font-semibold text-emerald-300 hover:text-white text-center">Xem chi tiết ↓</a>
            </div>
            <!-- Card 2: Não bộ -->
            <div class="glass-effect p-6 rounded-3xl text-white card-hover opacity-70 flex flex-col justify-between">
                <div class="text-center">
                    <div class="mx-auto w-16 h-16 mb-4 bg-white/20 rounded-full flex items-center justify-center">
                        <svg class="w-8 h-8 text-blue-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Hỗ trợ Phát triển Não bộ & Thị lực</h3>
                    <p class="text-sm text-white/70 mb-4">DHA, Omega-3, và các dưỡng chất cho trí thông minh.</p>
                </div>
                <a href="nao-bo.html" class="font-semibold text-emerald-300 hover:text-white text-center">Xem chi tiết ↓</a>
            </div>
            <!-- Card 3: Đề kháng -->
            <div class="glass-effect p-6 rounded-3xl text-white card-hover opacity-70 flex flex-col justify-between">
                <div class="text-center">
                    <div class="mx-auto w-16 h-16 mb-4 bg-white/20 rounded-full flex items-center justify-center">
                        <svg class="w-8 h-8 text-rose-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" />
                        </svg>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Tăng cường Sức đề kháng & Tiêu hóa</h3>
                    <p class="text-sm text-white/70 mb-4">Vitamin C, Kẽm, Probiotics và vitamin tổng hợp.</p>
                </div>
                <a href="de-khang.html" class="font-semibold text-emerald-300 hover:text-white text-center">Xem chi tiết ↓</a>
            </div>
            <!-- Card 4: Mẹ & Bé (Active) -->
            <div class="glass-effect p-6 rounded-3xl text-white card-hover border-2 border-pink-400 shadow-lg flex flex-col justify-between">
                <div class="text-center">
                    <div class="mx-auto w-16 h-16 mb-4 bg-white/20 rounded-full flex items-center justify-center">
                        <svg class="w-8 h-8 text-pink-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.321h5.365c.414 0 .584.536.283.766l-4.34 3.16a.563.563 0 0 0-.182.635l1.63 5.85c.128.463-.386.848-.794.536l-4.82-3.522a.563.563 0 0 0-.666 0l-4.82 3.522c-.408.312-.922-.073-.794-.536l1.63-5.85a.563.563 0 0 0-.182-.635l-4.34-3.16c-.301-.23-.131-.766.283-.766h5.365a.563.563 0 0 0 .475-.321L11.48 3.5Z" />
                        </svg>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Hỗ trợ Sức khỏe Phụ nữ & Thai kỳ</h3>
                    <p class="text-sm text-white/70 mb-4">Sắt, Axit Folic, và các vitamin cho mẹ bầu & sau sinh.</p>
                </div>
                <a href="#products" class="font-semibold text-pink-300 hover:text-white text-center">Xem chi tiết ↓</a>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container mx-auto p-4 md:p-8 mt-16">
        
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Enhanced Filter Sidebar -->
            <aside class="w-full lg:w-1/4">
                <div class="glass-effect p-6 rounded-3xl sticky top-24 fade-in">
                    <h3 class="font-bold text-2xl mb-6 text-white flex items-center">
                        <svg class="w-6 h-6 mr-3 text-pink-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                        </svg>
                        Bộ Lọc Thông Minh
                    </h3>
                    
                    <!-- Target Group Filter -->
                    <div class="mb-4 filter-group" data-filter-key="target_group">
                        <details class="text-white/90" open>
                            <summary>Đối tượng sử dụng</summary>
                            <div class="space-y-2 pt-2 pl-4">
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value="thai_ky" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>Phụ nữ mang thai</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value="cho_con_bu" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>Mẹ cho con bú</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value="phu_nu" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>Phụ nữ bình thường</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value="thieu_nu" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>Thiếu nữ dậy thì</span>
                                </label>
                            </div>
                        </details>
                    </div>

                    <!-- Iron Content Filter -->
                    <div class="mb-4 filter-group" data-filter-key="iron_content">
                        <details class="text-white/90" open>
                            <summary>Hàm lượng Sắt</summary>
                            <div class="space-y-2 pt-2 pl-4">
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value="<10" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>Dưới 10mg/Liều</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value="10-20" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>10-20mg/Liều</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value="20-30" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>20-30mg/Liều</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value=">30" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>Trên 30mg/Liều</span>
                                </label>
                            </div>
                        </details>
                    </div>

                    <!-- Folic Acid Content Filter -->
                    <div class="mb-4 filter-group" data-filter-key="folic_acid_content">
                        <details class="text-white/90" open>
                            <summary>Hàm lượng Axit Folic</summary>
                            <div class="space-y-2 pt-2 pl-4">
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value="<400" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>Dưới 400mcg/Liều</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value="400-600" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>400-600mcg/Liều</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value="600-800" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>600-800mcg/Liều</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="checkbox" value=">800" class="rounded text-pink-500 focus:ring-pink-500">
                                    <span>Trên 800mcg/Liều</span>
                                </label>
                            </div>
                        </details>
                    </div>

                    <!-- Multivitamin Filter -->
                    <div class="mb-4 filter-group" data-filter-key="is_multivitamin">
                        <details class="text-white/90" open>
                            <summary>Loại sản phẩm</summary>
                            <div class="space-y-2 pt-2 pl-4">
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="radio" name="multivitamin_filter" value="all" class="text-pink-500 focus:ring-pink-500" checked>
                                    <span>Tất cả</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="radio" name="multivitamin_filter" value="true" class="text-pink-500 focus:ring-pink-500">
                                    <span>Vitamin tổng hợp</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                    <input type="radio" name="multivitamin_filter" value="false" class="text-pink-500 focus:ring-pink-500">
                                    <span>Chuyên biệt (Sắt/Folic)</span>
                                </label>
                            </div>
                        </details>
                    </div>

                    <!-- Origin Filter -->
                    <div class="mb-4 filter-group" data-filter-key="country">
                        <details class="text-white/90">
                            <summary>Xuất Xứ</summary>
                            <div class="space-y-2 pt-2" id="origin-filter">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </details>
                    </div>

                    <!-- Clear Filters Button -->
                    <button id="clear-filters" class="w-full mt-4 px-4 py-3 bg-gradient-to-r from-red-500 to-pink-600 text-white font-semibold rounded-xl hover:shadow-lg transform hover:scale-105 transition-all duration-300">
                        Xóa Bộ Lọc
                    </button>
                </div>
            </aside>

            <!-- Products Grid -->
            <main class="w-full lg:w-3/4" id="products">
                <h2 class="text-4xl font-bold text-white text-center mb-8">
                    Sản phẩm Hỗ trợ Sức khỏe Phụ nữ & Thai kỳ
                </h2>
                <!-- Search and Sort -->
                <div class="glass-effect p-6 rounded-3xl mb-8 fade-in">
                    <div class="flex flex-col md:flex-row gap-4 items-center justify-between">
                        <div class="relative flex-1 max-w-md w-full">
                            <input type="text" id="search-input" placeholder="Tìm kiếm sản phẩm..." 
                                   class="w-full px-4 py-3 pl-12 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent">
                            <svg class="absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-white/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </div>
                        <div class="flex items-center space-x-4">
                            <select id="sort-select" class="px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-pink-500">
                                <option value="name">Sắp xếp theo tên</option>
                                <option value="price_low">Giá thấp đến cao</option>
                                <option value="price_high">Giá cao đến thấp</option>
                                <option value="rating">Đánh giá cao nhất</option>
                                <option value="iron_high">Hàm lượng Sắt cao nhất</option>
                            </select>
                            <div id="product-count" class="text-white/80 font-medium"></div>
                        </div>
                    </div>
                </div>

                <!-- Products Grid -->
                <div id="product-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                    <!-- Products will be inserted here by JavaScript -->
                </div>

                <!-- No Results -->
                <div id="no-results" class="hidden text-center py-16">
                    <div class="glass-effect p-12 rounded-3xl">
                        <svg class="mx-auto h-16 w-16 text-white/60 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <h3 class="text-2xl font-bold text-white mb-2">Không tìm thấy sản phẩm</h3>
                        <p class="text-white/70">Vui lòng thử lại với bộ lọc khác hoặc từ khóa tìm kiếm khác.</p>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Comparison Modal -->
    <div id="comparison-modal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="glass-effect max-w-6xl w-full rounded-3xl p-8 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-white flex items-center">
                    <svg class="w-6 h-6 mr-3 text-pink-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    So Sánh Sản Phẩm
                </h3>
                <button id="comparison-close" class="text-white/60 hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div id="comparison-content" class="comparison-table">
                <!-- Comparison table will be generated here -->
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification glass-effect p-4 rounded-xl text-white">
        <div class="flex items-center space-x-3">
            <svg class="w-5 h-5 text-pink-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <span id="notification-text">Đã thêm vào danh sách so sánh</span>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const app = {
                products: [
                    {
                        id: 301, category: 'me_va_be', name: 'Blackmores Pregnancy & Breast-Feeding Gold', brand: 'Blackmores', image: 'https://placehold.co/300x300/a855f7/white?text=Blackmores+Gold', price: 650000,
                        volume_ml: 0, total_doses_per_bottle: 180, origin: {country: 'Úc', continent: 'Châu Đại Dương'}, form: 'capsules',
                        declared_dose: { unit_count: 2, unit_name: 'viên', iron_mg: 18, folic_acid_mcg: 500, dha_mg: 125 },
                        target_groups: ['thai_ky', 'cho_con_bu'],
                        ingredients_details: { is_multivitamin: true, has_dha: true, natural_source: true },
                        rating: 4.8, reviews: 324, product_url: 'https://blackmores.vn/',
                        summary: {
                            benefits: [
                                'Hỗ trợ toàn diện sức khỏe mẹ và bé trong thai kỳ.',
                                'Giảm nguy cơ dị tật ống thần kinh ở thai nhi.',
                                'Bổ sung DHA cho phát triển não bộ và thị lực của bé.',
                                'Hỗ trợ sản xuất sữa mẹ chất lượng cao.'
                            ],
                            ingredients: [
                                'Axit Folic 500mcg',
                                'Sắt 18mg',
                                'DHA 125mg',
                                'Iodine, Vitamin D3, B12'
                            ],
                            users: 'Phụ nữ mang thai từ 12 tuần và cho con bú.'
                        }
                    },
                    {
                        id: 302, category: 'me_va_be', name: 'Elevit Pronatal', brand: 'Elevit', image: 'https://placehold.co/300x300/c084fc/white?text=Elevit+Pronatal', price: 520000,
                        volume_ml: 0, total_doses_per_bottle: 100, origin: {country: 'Đức', continent: 'Châu Âu'}, form: 'tablets',
                        declared_dose: { unit_count: 1, unit_name: 'viên', iron_mg: 60, folic_acid_mcg: 800, dha_mg: 0 },
                        target_groups: ['thai_ky'],
                        ingredients_details: { is_multivitamin: true, has_dha: false, natural_source: false },
                        rating: 4.6, reviews: 267, product_url: 'https://elevit.vn/',
                        summary: {
                            benefits: [
                                'Vitamin tổng hợp được khuyên dùng nhiều nhất cho bà bầu.',
                                'Hàm lượng Sắt và Axit Folic cao, phù hợp mẹ thiếu máu.',
                                'Hỗ trợ phát triển khỏe mạnh của thai nhi.',
                                'Giảm mệt mỏi và buồn nôn trong thai kỳ.'
                            ],
                            ingredients: [
                                'Axit Folic 800mcg',
                                'Sắt 60mg',
                                'Vitamin A, C, D, E, B-complex',
                                'Kẽm, Canxi, Magie'
                            ],
                            users: 'Phụ nữ mang thai từ khi chuẩn bị có thai.'
                        }
                    },
                    {
                        id: 303, category: 'me_va_be', name: 'Femibion 1 + 2', brand: 'Femibion', image: 'https://placehold.co/300x300/e879f9/white?text=Femibion', price: 780000,
                        volume_ml: 0, total_doses_per_bottle: 56, origin: {country: 'Đức', continent: 'Châu Âu'}, form: 'capsules',
                        declared_dose: { unit_count: 2, unit_name: 'viên', iron_mg: 14, folic_acid_mcg: 400, dha_mg: 200 },
                        target_groups: ['thai_ky', 'cho_con_bu'],
                        ingredients_details: { is_multivitamin: true, has_dha: true, metafolin: true },
                        rating: 4.9, reviews: 198, product_url: 'https://femibion.vn/',
                        summary: {
                            benefits: [
                                'Chứa Metafolin - dạng Folate dễ hấp thu nhất.',
                                'DHA cao hỗ trợ phát triển não bộ và mắt của bé.',
                                'Thiết kế 2 giai đoạn: trước sinh và sau sinh.',
                                'Không gây táo bón, dễ tiêu hóa.'
                            ],
                            ingredients: [
                                'Metafolin 400mcg (L-methylfolate)',
                                'Sắt chelate 14mg',
                                'DHA 200mg',
                                'Vitamin D3, B12, Iodine'
                            ],
                            users: 'Phụ nữ từ khi muốn có con đến khi cho con bú.'
                        }
                    },
                    {
                        id: 304, category: 'me_va_be', name: 'Nature Made Prenatal Multi + DHA', brand: 'Nature Made', image: 'https://placehold.co/300x300/f472b6/white?text=Nature+Prenatal', price: 450000,
                        volume_ml: 0, total_doses_per_bottle: 150, origin: {country: 'Mỹ', continent: 'Châu Mỹ'}, form: 'softgels',
                        declared_dose: { unit_count: 1, unit_name: 'viên', iron_mg: 27, folic_acid_mcg: 600, dha_mg: 200 },
                        target_groups: ['thai_ky', 'cho_con_bu'],
                        ingredients_details: { is_multivitamin: true, has_dha: true, usp_verified: true },
                        rating: 4.4, reviews: 289, product_url: 'https://naturemade.com/',
                        summary: {
                            benefits: [
                                'Chứng nhận USP về độ tinh khiết và hiệu lực.',
                                'DHA từ cá biển sạch, không mùi tanh.',
                                'Hàm lượng Sắt cao, phù hợp mẹ bầu thiếu máu.',
                                'Viên mềm dễ nuốt, ít gây buồn nôn.'
                            ],
                            ingredients: [
                                'Axit Folic 600mcg',
                                'Sắt 27mg',
                                'DHA 200mg từ cá biển',
                                'Vitamin A, C, D, E, B-complex'
                            ],
                            users: 'Phụ nữ mang thai và cho con bú.'
                        }
                    },
                    {
                        id: 305, category: 'me_va_be', name: 'Vita Mama Iron + Folic Acid', brand: 'Vita', image: 'https://placehold.co/300x300/fb7185/white?text=Vita+Mama', price: 180000,
                        volume_ml: 0, total_doses_per_bottle: 100, origin: {country: 'Việt Nam', continent: 'Châu Á'}, form: 'tablets',
                        declared_dose: { unit_count: 1, unit_name: 'viên', iron_mg: 30, folic_acid_mcg: 400, dha_mg: 0 },
                        target_groups: ['thai_ky', 'thieu_nu'],
                        ingredients_details: { is_multivitamin: false, has_dha: false, iron_bisglycinate: true },
                        rating: 4.2, reviews: 145, product_url: 'https://vita.vn/',
                        summary: {
                            benefits: [
                                'Sắt Bisglycinate dễ hấp thu, ít gây táo bón.',
                                'Chuyên biệt cho phụ nữ thiếu máu.',
                                'Giá cả phải chăng, phù hợp kinh tế gia đình.',
                                'Sản phẩm nội địa đạt chuẩn GMP.'
                            ],
                            ingredients: [
                                'Sắt Bisglycinate 30mg',
                                'Axit Folic 400mcg',
                                'Vitamin C 60mg',
                                'Vitamin B12 2.4mcg'
                            ],
                            users: 'Phụ nữ mang thai, thiếu nữ dậy thì, phụ nữ thiếu máu.'
                        }
                    },
                    {
                        id: 306, category: 'me_va_be', name: 'Garden of Life Vitamin Code RAW Prenatal', brand: 'Garden of Life', image: 'https://placehold.co/300x300/db2777/white?text=Garden+RAW', price: 720000,
                        volume_ml: 0, total_doses_per_bottle: 90, origin: {country: 'Mỹ', continent: 'Châu Mỹ'}, form: 'capsules',
                        declared_dose: { unit_count: 3, unit_name: 'viên', iron_mg: 18, folic_acid_mcg: 600, dha_mg: 0 },
                        target_groups: ['thai_ky', 'cho_con_bu'],
                        ingredients_details: { is_multivitamin: true, has_dha: false, raw_food: true },
                        rating: 4.7, reviews: 234, product_url: 'https://gardenoflife.com/',
                        summary: {
                            benefits: [
                                'Vitamin từ thực phẩm thô, dễ tiêu hóa.',
                                'Không chất tổng hợp, hoàn toàn tự nhiên.',
                                'Chứa probiotics hỗ trợ tiêu hóa.',
                                'Không gây buồn nôn hay táo bón.'
                            ],
                            ingredients: [
                                'Folate từ thực phẩm tự nhiên 600mcg',
                                'Sắt từ thực phẩm 18mg',
                                'Probiotics và Enzymes',
                                'Vitamin từ rau củ và trái cây hữu cơ'
                            ],
                            users: 'Phụ nữ ưa thích sản phẩm tự nhiên, hữu cơ.'
                        }
                    },
                    {
                        id: 307, category: 'me_va_be', name: 'One A Day Women\'s Prenatal', brand: 'One A Day', image: 'https://placehold.co/300x300/be185d/white?text=OneADay+Prenatal', price: 350000,
                        volume_ml: 0, total_doses_per_bottle: 120, origin: {country: 'Mỹ', continent: 'Châu Mỹ'}, form: 'tablets',
                        declared_dose: { unit_count: 1, unit_name: 'viên', iron_mg: 28, folic_acid_mcg: 400, dha_mg: 0 },
                        target_groups: ['thai_ky'],
                        ingredients_details: { is_multivitamin: true, has_dha: false, once_daily: true },
                        rating: 4.3, reviews: 167, product_url: 'https://oneaday.com/',
                        summary: {
                            benefits: [
                                'Chỉ cần uống 1 viên/ngày, tiện lợi.',
                                'Hàm lượng Sắt cao, phù hợp mẹ bầu Việt Nam.',
                                'Không chứa Gluten, phù hợp người dị ứng.',
                                'Thương hiệu tin cậy tại Mỹ hơn 75 năm.'
                            ],
                            ingredients: [
                                'Axit Folic 400mcg',
                                'Sắt 28mg',
                                'Vitamin A, C, D, E, B-complex',
                                'Canxi, Iodine, Kẽm'
                            ],
                            users: 'Phụ nữ mang thai muốn tiện lợi 1 viên/ngày.'
                        }
                    }
                ],

                selectedProducts: [],
                
                init: function() {
                    this.initializeFilters();
                    this.renderProducts(this.products.filter(p => p.category === 'me_va_be'));
                    this.setupEventListeners();
                    this.updateProductCount(this.products.filter(p => p.category === 'me_va_be').length);
                },

                initializeFilters: function() {
                    const originFilter = document.getElementById('origin-filter');
                    const originsByContinent = this.products.reduce((acc, p) => {
                        if (!acc[p.origin.continent]) {
                            acc[p.origin.continent] = new Set();
                        }
                        acc[p.origin.continent].add(p.origin.country);
                        return acc;
                    }, {});

                    originFilter.innerHTML = Object.keys(originsByContinent).sort().map(continent => `
                        <details class="text-white/90">
                            <summary>${continent}</summary>
                            <div class="space-y-2 pt-2 pl-4">
                                ${[...originsByContinent[continent]].sort().map(country => `
                                    <label class="flex items-center space-x-3 cursor-pointer text-white/80 hover:text-white transition-colors font-normal">
                                        <input type="checkbox" value="${country}" class="rounded text-pink-500 focus:ring-pink-500">
                                        <span>${country}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </details>
                    `).join('');
                },
                
                setupEventListeners: function() {
                    document.getElementById('search-input').addEventListener('input', () => this.applyFilters());
                    document.getElementById('sort-select').addEventListener('change', () => this.applyFilters());
                    document.querySelectorAll('.filter-group input').forEach(input => {
                        input.addEventListener('change', () => this.applyFilters());
                    });
                    document.getElementById('clear-filters').addEventListener('click', () => this.clearAllFilters());
                    
                    const compareMenu = document.getElementById('compare-menu-container');
                    if (compareMenu) {
                        compareMenu.addEventListener('click', (e) => {
                            const compareBtn = e.target.closest('#compare-btn');
                            const dropdown = document.getElementById('compare-dropdown');
                            if(compareBtn && dropdown) {
                                dropdown.classList.toggle('hidden');
                            }
                            if(e.target.dataset.compareType) {
                                e.preventDefault();
                                this.showComparison(e.target.dataset.compareType);
                                if (dropdown) dropdown.classList.add('hidden');
                            }
                        });
                    }

                    const comparisonClose = document.getElementById('comparison-close');
                    if(comparisonClose) {
                        comparisonClose.addEventListener('click', () => {
                            document.getElementById('comparison-modal').classList.add('hidden');
                        });
                    }

                    const productGrid = document.getElementById('product-grid');
                    if(productGrid){
                        productGrid.addEventListener('click', (e) => {
                            const flipTrigger = e.target.closest('.flip-trigger');
                            if (flipTrigger) {
                                const card = flipTrigger.closest('.flip-card');
                                if (card) card.classList.toggle('is-flipped');
                            }
                            
                            const compareToggle = e.target.closest('.compare-toggle');
                            if (compareToggle) {
                                const productId = parseInt(compareToggle.dataset.productId);
                                this.toggleProductSelection(productId);
                            }
                        });
                    }
                },

                applyFilters: function() {
                    const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
                    const sortBy = document.getElementById('sort-select').value;
                    
                    let filteredProducts = this.products.filter(p => p.category === 'me_va_be');
                    
                    // Apply search filter
                    if (searchTerm) {
                        filteredProducts = filteredProducts.filter(p => 
                            p.name.toLowerCase().includes(searchTerm) ||
                            p.brand.toLowerCase().includes(searchTerm) ||
                            p.origin.country.toLowerCase().includes(searchTerm)
                        );
                    }

                    // Apply target group filter
                    const targetGroupFilters = Array.from(document.querySelectorAll('[data-filter-key="target_group"] input:checked')).map(input => input.value);
                    if (targetGroupFilters.length > 0) {
                        filteredProducts = filteredProducts.filter(p => 
                            p.target_groups.some(group => targetGroupFilters.includes(group))
                        );
                    }

                    // Apply Iron content filter
                    const ironFilters = Array.from(document.querySelectorAll('[data-filter-key="iron_content"] input:checked')).map(input => input.value);
                    if (ironFilters.length > 0) {
                        filteredProducts = filteredProducts.filter(p => {
                            const iron = p.declared_dose.iron_mg;
                            return ironFilters.some(filter => {
                                if (filter === '<10') return iron < 10;
                                if (filter === '10-20') return iron >= 10 && iron <= 20;
                                if (filter === '20-30') return iron >= 20 && iron <= 30;
                                if (filter === '>30') return iron > 30;
                                return false;
                            });
                        });
                    }

                    // Apply Folic Acid content filter
                    const folicFilters = Array.from(document.querySelectorAll('[data-filter-key="folic_acid_content"] input:checked')).map(input => input.value);
                    if (folicFilters.length > 0) {
                        filteredProducts = filteredProducts.filter(p => {
                            const folic = p.declared_dose.folic_acid_mcg;
                            return folicFilters.some(filter => {
                                if (filter === '<400') return folic < 400;
                                if (filter === '400-600') return folic >= 400 && folic <= 600;
                                if (filter === '600-800') return folic >= 600 && folic <= 800;
                                if (filter === '>800') return folic > 800;
                                return false;
                            });
                        });
                    }

                    // Apply multivitamin filter
                    const multivitaminFilter = document.querySelector('input[name="multivitamin_filter"]:checked')?.value;
                    if (multivitaminFilter && multivitaminFilter !== 'all') {
                        const isMultivitamin = multivitaminFilter === 'true';
                        filteredProducts = filteredProducts.filter(p => p.ingredients_details.is_multivitamin === isMultivitamin);
                    }

                    // Apply origin filter
                    const originFilters = Array.from(document.querySelectorAll('[data-filter-key="country"] input:checked')).map(input => input.value);
                    if (originFilters.length > 0) {
                        filteredProducts = filteredProducts.filter(p => 
                            originFilters.includes(p.origin.country)
                        );
                    }

                    // Apply sorting
                    this.sortProducts(filteredProducts, sortBy);
                    
                    this.renderProducts(filteredProducts);
                    this.updateProductCount(filteredProducts.length);
                },

                sortProducts: function(products, sortBy) {
                    switch(sortBy) {
                        case 'name':
                            products.sort((a, b) => a.name.localeCompare(b.name));
                            break;
                        case 'price_low':
                            products.sort((a, b) => a.price - b.price);
                            break;
                        case 'price_high':
                            products.sort((a, b) => b.price - a.price);
                            break;
                        case 'rating':
                            products.sort((a, b) => b.rating - a.rating);
                            break;
                        case 'iron_high':
                            products.sort((a, b) => b.declared_dose.iron_mg - a.declared_dose.iron_mg);
                            break;
                    }
                },

                renderProducts: function(products) {
                    const productGrid = document.getElementById('product-grid');
                    const noResults = document.getElementById('no-results');
                    
                    if (products.length === 0) {
                        productGrid.classList.add('hidden');
                        noResults.classList.remove('hidden');
                        return;
                    }
                    
                    productGrid.classList.remove('hidden');
                    noResults.classList.add('hidden');
                    
                    productGrid.innerHTML = products.map(product => `
                        <div class="glass-effect rounded-3xl overflow-hidden hover:shadow-xl transition-all duration-300 card-hover product-card ${this.selectedProducts.includes(product.id) ? 'selected' : ''}" data-product-id="${product.id}">
                            <div class="flip-card">
                                <div class="flip-card-inner">
                                    <div class="flip-card-front glass-effect">
                                        <div class="p-6">
                                            <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover rounded-2xl mb-4">
                                            <h3 class="text-xl font-bold text-white mb-2 line-clamp-2">${product.name}</h3>
                                            <p class="text-purple-200 text-sm mb-3">${product.brand} - ${product.origin.country}</p>
                                            
                                            <div class="space-y-2 mb-4">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-white/70 text-sm">Sắt:</span>
                                                    <span class="text-purple-200 font-semibold">${product.declared_dose.iron_mg}mg</span>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-white/70 text-sm">Folic:</span>
                                                    <span class="text-purple-200 font-semibold">${product.declared_dose.folic_acid_mcg}mcg</span>
                                                </div>
                                                ${product.declared_dose.dha_mg > 0 ? `
                                                <div class="flex justify-between items-center">
                                                    <span class="text-white/70 text-sm">DHA:</span>
                                                    <span class="text-purple-200 font-semibold">${product.declared_dose.dha_mg}mg</span>
                                                </div>
                                                ` : ''}
                                                <div class="flex justify-between items-center">
                                                    <span class="text-white/70 text-sm">Dạng:</span>
                                                    <span class="text-purple-200 font-semibold">${this.getFormText(product.form)}</span>
                                                </div>
                                            </div>
                                            
                                            <div class="flex items-center justify-between mb-4">
                                                <div class="flex items-center space-x-1">
                                                    ${Array.from({length: 5}, (_, i) => `
                                                        <svg class="w-4 h-4 ${i < Math.floor(product.rating) ? 'text-yellow-400' : 'text-gray-400'}" fill="currentColor" viewBox="0 0 20 20">
                                                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                                        </svg>
                                                    `).join('')}
                                                    <span class="text-white/70 text-sm ml-1">${product.rating} (${product.reviews})</span>
                                                </div>
                                            </div>
                                            
                                            <div class="text-center mb-4">
                                                <span class="text-2xl font-bold text-white">${product.price.toLocaleString('vi-VN')}₫</span>
                                                <p class="text-white/60 text-sm">${product.total_doses_per_bottle} ${product.form === 'tablets' || product.form === 'capsules' ? 'viên' : 'liều'}</p>
                                            </div>
                                        </div>
                                        
                                        <div class="px-6 pb-6 space-y-3">
                                            <button class="flip-trigger w-full px-4 py-2 bg-white/20 text-white rounded-xl hover:bg-white/30 transition-colors">
                                                Xem Chi Tiết
                                            </button>
                                            <div class="grid grid-cols-2 gap-3">
                                                <button class="compare-toggle px-4 py-2 ${this.selectedProducts.includes(product.id) ? 'bg-emerald-600 text-white' : 'bg-white/10 text-white/80'} rounded-xl hover:bg-emerald-600 hover:text-white transition-all" data-product-id="${product.id}">
                                                    ${this.selectedProducts.includes(product.id) ? 'Đã chọn ✓' : 'So sánh'}
                                                </button>
                                                <a href="${product.product_url}" target="_blank" class="px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-700 text-white rounded-xl hover:shadow-lg transition-all text-center">
                                                    Mua ngay
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="flip-card-back glass-effect">
                                        <button class="flip-trigger absolute top-4 right-4 text-white/60 hover:text-white z-10">
                                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                            </svg>
                                        </button>
                                        
                                        <h4>Công dụng chính:</h4>
                                        <ul class="mb-4">
                                            ${product.summary.benefits.map(benefit => `<li>${benefit}</li>`).join('')}
                                        </ul>
                                        
                                        <h4>Thành phần:</h4>
                                        <ul class="mb-4">
                                            ${product.summary.ingredients.map(ingredient => `<li>${ingredient}</li>`).join('')}
                                        </ul>
                                        
                                        <h4>Đối tượng sử dụng:</h4>
                                        <p class="text-white/90 text-sm">${product.summary.users}</p>
                                        
                                        <div class="mt-4 pt-4 border-t border-white/20">
                                            <div class="grid grid-cols-2 gap-3">
                                                <button class="compare-toggle px-4 py-2 ${this.selectedProducts.includes(product.id) ? 'bg-emerald-600 text-white' : 'bg-white/10 text-white/80'} rounded-xl hover:bg-emerald-600 hover:text-white transition-all text-sm" data-product-id="${product.id}">
                                                    ${this.selectedProducts.includes(product.id) ? 'Đã chọn ✓' : 'So sánh'}
                                                </button>
                                                <a href="${product.product_url}" target="_blank" class="px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-700 text-white rounded-xl hover:shadow-lg transition-all text-center text-sm">
                                                    Mua ngay
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('');
                },

                getFormText: function(form) {
                    const formTexts = {
                        'capsules': 'Viên nang',
                        'tablets': 'Viên nén',
                        'softgels': 'Viên mềm',
                        'drops': 'Dung dịch nhỏ giọt',
                        'syrup': 'Siro'
                    };
                    return formTexts[form] || form;
                },

                toggleProductSelection: function(productId) {
                    const index = this.selectedProducts.indexOf(productId);
                    
                    if (index === -1) {
                        if (this.selectedProducts.length < 4) {
                            this.selectedProducts.push(productId);
                            this.showNotification('Đã thêm vào danh sách so sánh');
                        } else {
                            this.showNotification('Chỉ có thể so sánh tối đa 4 sản phẩm');
                            return;
                        }
                    } else {
                        this.selectedProducts.splice(index, 1);
                        this.showNotification('Đã xóa khỏi danh sách so sánh');
                    }
                    
                    this.updateCompareButton();
                    this.updateProductCards();
                },

                updateCompareButton: function() {
                    const compareBtn = document.getElementById('compare-btn');
                    const compareCount = document.getElementById('compare-count');
                    
                    if (compareBtn && compareCount) {
                        compareCount.textContent = this.selectedProducts.length;
                        
                        if (this.selectedProducts.length >= 2) {
                            compareBtn.disabled = false;
                            compareBtn.classList.remove('opacity-50');
                        } else {
                            compareBtn.disabled = true;
                            compareBtn.classList.add('opacity-50');
                        }
                    }
                },

                updateProductCards: function() {
                    const productCards = document.querySelectorAll('.product-card');
                    productCards.forEach(card => {
                        const productId = parseInt(card.dataset.productId);
                        const compareButtons = card.querySelectorAll('.compare-toggle');
                        
                        if (this.selectedProducts.includes(productId)) {
                            card.classList.add('selected');
                            compareButtons.forEach(btn => {
                                btn.classList.remove('bg-white/10', 'text-white/80');
                                btn.classList.add('bg-emerald-600', 'text-white');
                                btn.textContent = 'Đã chọn ✓';
                            });
                        } else {
                            card.classList.remove('selected');
                            compareButtons.forEach(btn => {
                                btn.classList.remove('bg-emerald-600', 'text-white');
                                btn.classList.add('bg-white/10', 'text-white/80');
                                btn.textContent = 'So sánh';
                            });
                        }
                    });
                },

                showNotification: function(message) {
                    const notification = document.getElementById('notification');
                    const notificationText = document.getElementById('notification-text');
                    
                    if (notification && notificationText) {
                        notificationText.textContent = message;
                        notification.classList.add('show');
                        
                        setTimeout(() => {
                            notification.classList.remove('show');
                        }, 3000);
                    }
                },

                showComparison: function(type) {
                    if (this.selectedProducts.length < 2) {
                        this.showNotification('Vui lòng chọn ít nhất 2 sản phẩm để so sánh');
                        return;
                    }

                    const modal = document.getElementById('comparison-modal');
                    const content = document.getElementById('comparison-content');
                    
                    if (modal && content) {
                        content.innerHTML = this.generateComparisonContent(type);
                        modal.classList.remove('hidden');
                    }
                },

                generateComparisonContent: function(type) {
                    const selectedProductsData = this.products.filter(p => this.selectedProducts.includes(p.id));
                    
                    if (type === 'dosage') {
                        return this.generateDosageComparison(selectedProductsData);
                    } else if (type === 'cost') {
                        return this.generateCostComparison(selectedProductsData);
                    } else if (type === 'iron') {
                        return this.generateIronComparison(selectedProductsData);
                    } else if (type === 'folic_acid') {
                        return this.generateFolicAcidComparison(selectedProductsData);
                    }
                },

                generateDosageComparison: function(products) {
                    return `
                        <div class="overflow-x-auto">
                            <h4 class="text-xl font-bold text-white mb-4">So sánh liều dùng khuyến nghị</h4>
                            <div class="space-y-3">
                                ${products.map(product => {
                                    const dosage = product.declared_dose.unit_count;
                                    const maxDosage = Math.max(...products.map(p => p.declared_dose.unit_count));
                                    const percentage = (dosage / maxDosage) * 100;
                                    
                                    return `
                                        <div class="flex items-center space-x-4">
                                            <div class="w-48 text-white text-sm">${product.name}</div>
                                            <div class="flex-1 bg-white/20 rounded-full h-8 relative">
                                                <div class="comparison-bar bg-purple-500 h-full rounded-full transition-all duration-1000" style="width: ${percentage}%"></div>
                                                <span class="absolute inset-0 flex items-center justify-center text-white text-sm font-medium">
                                                    ${dosage} ${product.declared_dose.unit_name}/ngày
                                                </span>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                },

                generateCostComparison: function(products) {
                    return `
                        <div class="overflow-x-auto">
                            <h4 class="text-xl font-bold text-white mb-4">So sánh chi phí mỗi ngày</h4>
                            <div class="space-y-3">
                                ${products.map(product => {
                                    const costPerDose = product.price / product.total_doses_per_bottle;
                                    const costPerDay = costPerDose * product.declared_dose.unit_count;
                                    const maxCost = Math.max(...products.map(p => (p.price / p.total_doses_per_bottle) * p.declared_dose.unit_count));
                                    const percentage = (costPerDay / maxCost) * 100;
                                    
                                    return `
                                        <div class="flex items-center space-x-4">
                                            <div class="w-48 text-white text-sm">${product.name}</div>
                                            <div class="flex-1 bg-white/20 rounded-full h-8 relative">
                                                <div class="comparison-bar bg-gradient-to-r from-green-500 to-red-500 h-full rounded-full" style="width: ${percentage}%"></div>
                                                <span class="absolute inset-0 flex items-center justify-center text-white text-sm font-medium">
                                                    ${Math.round(costPerDay).toLocaleString('vi-VN')}₫/ngày
                                                </span>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                },

                generateIronComparison: function(products) {
                    return `
                        <div class="overflow-x-auto">
                            <h4 class="text-xl font-bold text-white mb-4">So sánh hàm lượng Sắt mỗi liều</h4>
                            <div class="space-y-3">
                                ${products.map(product => {
                                    const ironAmount = product.declared_dose.iron_mg;
                                    const maxIron = Math.max(...products.map(p => p.declared_dose.iron_mg));
                                    const percentage = (ironAmount / maxIron) * 100;
                                    
                                    return `
                                        <div class="flex items-center space-x-4">
                                            <div class="w-48 text-white text-sm">${product.name}</div>
                                            <div class="flex-1 bg-white/20 rounded-full h-8 relative">
                                                <div class="comparison-bar bg-gradient-to-r from-red-500 to-orange-500 h-full rounded-full" style="width: ${percentage}%"></div>
                                                <span class="absolute inset-0 flex items-center justify-center text-white text-sm font-medium">
                                                    ${ironAmount}mg Sắt
                                                </span>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                },

                generateFolicAcidComparison: function(products) {
                    return `
                        <div class="overflow-x-auto">
                            <h4 class="text-xl font-bold text-white mb-4">So sánh hàm lượng Axit Folic mỗi liều</h4>
                            <div class="space-y-3">
                                ${products.map(product => {
                                    const folicAmount = product.declared_dose.folic_acid_mcg;
                                    const maxFolic = Math.max(...products.map(p => p.declared_dose.folic_acid_mcg));
                                    const percentage = (folicAmount / maxFolic) * 100;
                                    
                                    return `
                                        <div class="flex items-center space-x-4">
                                            <div class="w-48 text-white text-sm">${product.name}</div>
                                            <div class="flex-1 bg-white/20 rounded-full h-8 relative">
                                                <div class="comparison-bar bg-gradient-to-r from-purple-500 to-pink-500 h-full rounded-full" style="width: ${percentage}%"></div>
                                                <span class="absolute inset-0 flex items-center justify-center text-white text-sm font-medium">
                                                    ${folicAmount}mcg Folic
                                                </span>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                },

                updateProductCount: function(count) {
                    const productCountEl = document.getElementById('product-count');
                    if (productCountEl) {
                        productCountEl.textContent = `${count} sản phẩm`;
                    }
                },

                clearAllFilters: function() {
                    // Clear search
                    document.getElementById('search-input').value = '';
                    
                    // Clear all checkboxes
                    document.querySelectorAll('.filter-group input[type="checkbox"]').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    
                    // Reset radio buttons
                    document.querySelectorAll('.filter-group input[type="radio"][value="all"]').forEach(radio => {
                        radio.checked = true;
                    });
                    
                    // Reset sort
                    document.getElementById('sort-select').value = 'name';
                    
                    // Re-apply filters
                    this.applyFilters();
                    
                    this.showNotification('Đã xóa tất cả bộ lọc');
                }
            };

            app.init();
        });
    </script>
    
</body>
</html>